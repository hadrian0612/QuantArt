# PeakKDJSelector (填坑战法) 配置文件
# 一个策略一个配置文件，直接包含策略配置，无需 selectors 层级

class: PeakKDJSelector
alias: 填坑战法
activate: true

# ========== 策略原理简介 ==========
# 填坑战法：基于局部高点（Peaks）结构 + KDJ 超卖的“回踩填坑”策略
#
# 核心逻辑：
# 1. 峰值结构：利用局部峰值（基于 open/close 的最大值）识别一段上升波段中的前高和新高
# 2. 价差约束：当前价格相对前高的波动率不能过大（fluc_threshold）
# 3. 峰间结构：要求前高在中间所有峰值之上，保证结构上的“阶梯式上升”
# 4. KDJ 超卖：当日 J 值极低（绝对阈值或历史分位），避免在高位追涨
# 5. 知行条件：当日短期线和长期线的关系需满足多头要求
#
# 适用场景：在上升趋势和峰值结构形成后，捕捉回踩前高附近的“填坑”机会
# ===================================

params:
  # KDJ 指标 J 值的绝对阈值：J < j_threshold 时认为处于低位
  # 一般为负值或接近 0，越小越严格，建议范围：-20 ~ 10
  j_threshold: 10

  # 计算 J 值历史分位数时的最大回看窗口（交易日数）
  # 同时也用于限制历史数据长度，建议范围：60 ~ 250
  max_window: 120

  # 当前收盘价与选定前高之间允许的最大波动率
  # 例如 0.03 表示 |close_today - peak_price| / peak_price <= 3%
  # 值越小，越贴近“前高附近”；建议范围：0.02 ~ 0.08
  fluc_threshold: 0.03

  # 峰值前高相对区间最低收盘价的安全间隔比例
  # 确保前高明显高于中间回调低点，避免结构过于平坦
  # 例如 0.2 表示 oc_prev > 区间最低收盘价 * (1 + 0.2)
  # 建议范围：0.1 ~ 0.5
  gap_threshold: 0.2

  # KDJ 指标 J 值的分位数阈值（0-1之间）
  # 当日 J 值 <= 过去 max_window 日 J 值该分位数时，也认为处于低位
  # 建议范围：0.05 ~ 0.20
  j_q_threshold: 0.10

